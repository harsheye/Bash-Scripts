#!/bin/bash


device=`nmcli device | head -2 | tail -1 | cut -f1 -d' '`

x=`ip a | grep inet | grep global | colrm 1 4 | cut -f2 -d' ' | tr '/' ' ' | cut -f1 -d' ' | head -1`	
		 
echo "you ip is : $x"
		  	

x1=`ping -c1 8.8.8.8 | head -2 | tail -1 | rev | cut -f1 -d' '`
	
	
	
	
x3=`ping -c1 $x | head -2 | tail -1 | rev | cut -f1 -d' '`

if [ $x3 = sm ] && [ $x1 = sm ]; then
	echo "connection is successfully completed"
else 
	ifdown $device



	ifup $device
   if [ $? -eq 0 ]; then
   	  			

			device=`nmcli device | head -2 | tail -1 | cut -f1 -d' '`

			 x=` ip a | grep inet | grep global | colrm 1 4 | cut -f2 -d' ' | tr '/' ' ' | cut -f1 -d' ' | head -1`	
		 
			 echo "you ip is : $x"
		  	

			x1=`ping -c1 8.8.8.8 | head -2 | tail -1 | rev | cut -f1 -d' '`
	
	
	
	
			x3=`ping -c1 $x | head -2 | tail -1 | rev | cut -f1 -d' '`

	if [ $x3 = sm ] && [ $x1 = sm ]; then
		echo "connection is successfully completed"
	else 
		ifdown $device
		ifup $device






			if [ $? -eq 0 ]; then
			
				echo "TYPE=Ethernet
				BOOTPROTO=dhcp
				EFROUTE=\"yes\"
				NAME=$device
				UUID=f8b3cfaf-af73-4e15-ad83-97a4b2762a7b
				DEVICE=$device
				ONBOOT=yes
				DEFROUTE=yes" > /etc/sysconfig/network-scripts/ifcfg-$device

					systemctl restart network
					ifdown $device
					ifup $device

		
					if [ $? -eq 0 ]; then
	  			
	
						device=`nmcli device | head -2 | tail -1 | cut -f1 -d' '`

						 x=` ip a | grep inet | grep global | colrm 1 4 | cut -f2 -d' ' | tr '/' ' ' | cut -f1 -d' ' | head -1`	
		 	 			echo "you ip is : $x"
		  	

						x1=`ping -c1 8.8.8.8 | head -2 | tail -1 | rev | cut -f1 -d' '`
	
	
	
	
						x3=`ping -c1 $x | head -2 | tail -1 | rev | cut -f1 -d' '`

							if [ $x3 = sm ] && [ $x1 = sm ]; then
								echo "connection is successfully completed"
							else 
	
								echo"try changing the network adapter in your machine manager"
						





	

							fi
		
					else
						
								echo"try changing the network adapter in your machine manager"
					fi
			

			fi
		

	fi
   else
	
			
				echo "TYPE=Ethernet
BOOTPROTO=dhcp
EFROUTE=\"yes\"
NAME=$device
DEVICE=$device
ONBOOT=yes
DEFROUTE=yes" > /etc/sysconfig/network-scripts/ifcfg-$device

					systemctl restart network
					ifdown $device
					ifup $device

		
					if [ $? -eq 0 ]; then
	  			
	
						device=`nmcli device | head -2 | tail -1 | cut -f1 -d' '`

						 x=` ip a | grep inet | grep global | colrm 1 4 | cut -f2 -d' ' | tr '/' ' ' | cut -f1 -d' ' | head -1`	
		 	 			echo "you ip is : $x"
		  	

						x1=`ping -c1 8.8.8.8 | head -2 | tail -1 | rev | cut -f1 -d' '`
	
	
	
	
						x3=`ping -c1 $x | head -2 | tail -1 | rev | cut -f1 -d' '`

							if [ $x3 = sm ] && [ $x1 = sm ]; then
								echo "connection is successfully completed"
							else 
	
								echo "try changing the network adapter in your machine manager"
						





	

							fi
		
					else
						echo"try changing the network adapter in your machine manager"
					fi

   fi

fi
 


